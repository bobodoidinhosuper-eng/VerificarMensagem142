<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>142 | VERIFICADOR DE ASSINATURA</title>
    <script src="https://unpkg.com/openpgp@5.11.0/dist/openpgp.min.js"></script>
    <style>
        /* UI ESTILO HACKER/CICADA */
        body {
            background-color: #0d0d0d;
            color: #00ff41;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            width: 90%;
            max-width: 800px;
            border: 1px solid #333;
            padding: 30px;
            background: #000;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
        }

        h1 {
            text-align: center;
            letter-spacing: 5px;
            border-bottom: 1px solid #00ff41;
            padding-bottom: 15px;
            margin-top: 0;
        }

        .instructions {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 10px;
            text-align: center;
        }

        textarea {
            width: 100%;
            height: 300px;
            background: #111;
            color: #eee;
            border: 1px solid #333;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            resize: vertical;
            box-sizing: border-box;
            outline: none;
        }

        textarea:focus {
            border-color: #00ff41;
        }

        button {
            width: 100%;
            padding: 15px;
            margin-top: 15px;
            background: #004411;
            color: #00ff41;
            border: 1px solid #00ff41;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: 0.2s;
        }

        button:hover {
            background: #00ff41;
            color: #000;
        }

        #result {
            margin-top: 20px;
            padding: 20px;
            text-align: center;
            font-weight: bold;
            display: none; /* Escondido até ter resultado */
            border: 1px dashed;
        }

        .success {
            border-color: #00ff41;
            color: #00ff41;
            background: rgba(0, 255, 65, 0.05);
        }

        .failure {
            border-color: #ff0000;
            color: #ff0000;
            background: rgba(255, 0, 0, 0.05);
        }
    </style>
</head>
<body>

<div class="container">
    <h1>142 PUBLIC VERIFIER</h1>
    
    <div class="instructions">
        COLE A MENSAGEM ASSINADA (BEGIN PGP SIGNED MESSAGE) ABAIXO:
    </div>

    <textarea id="pgp-message" placeholder="-----BEGIN PGP SIGNED MESSAGE-----&#10;Hash: SHA512&#10;&#10;Sua mensagem aqui...&#10;-----BEGIN PGP SIGNATURE-----&#10;..."></textarea>

    <button onclick="verifySignature()">VERIFICAR AUTENTICIDADE</button>

    <div id="result"></div>
</div>

<script>
    // AQUI ESTÁ APENAS A SUA CHAVE PÚBLICA. 
    // ISSO É SEGURO PARA PUBLICAR.
    const publicKeyArmored = `-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: Keybase OpenPGP v2.1.15
Comment: https://keybase.io/crypto

xo0EaVSHgAEEALiiw//n8Yw1BwfDnajuLG9PfVhUeNmUahLhgNz4UVGNfsgFhQv+
GprSjBSP3fb9zh+BhsVqjEJSrCedJ0p0XbMjc0pPGbiJoHK/yDSgX5VBIZeqE2qL
JsWOTGhkqMdbJkiCVafTuKxksVlxF+aRcScyGILYSpeoUSNx4OL2mxTlABEBAAHN
EzE0MiA8MTQyQGVuaWdtYS5pbz7CtAQTAQoAHgUCaVSHgAIbLwMLCQcDFQoIAh4B
AheAAxYCAQIZAQAKCRBW7Vdr1N+awHnUBACUHFOyjGJ2I3fsl8t72ECPvN7h3Emu
x4g46jcri6pPJDUxneliwY/9HRBBmHC1EV3J5u2YuvIjmsrshfNmqRIxK9rUDidf
w18WX2j6sEc77+447lS8F5cImtYNu7hQGaNxckHAKWxdcDEp8JOB0e/xgZY9Oo2p
DzYhihshUsLSMc6NBGlUh4ABBAC6Ys2fYgCeVbBsO0Nr4eBbQrPjSiU273j5Y1yw
3QdF9K5DDuYppL5+tILObYxe29vwzARRabZ/xfM9ISQ4RZV7UwYlSlxxfAfWm+0I
PWWcPfai8XfpfN8se5KRddtGHY5xlfU7XIdZmT3uet0+xqRr9aFx4vSjTDNvRv/9
C8rzYQARAQABwsCDBBgBCgAPBQJpVIeABQkPCZwAAhsuAKgJEFbtV2vU35rAnSAE
GQEKAAYFAmlUh4AACgkQDs1obifANQ02PQP/WYiPwLnT103vRAB6RipKJwuGjvhe
bCx20B/+sPCNvmazEicNDRom7+b0N7qTQd5JcFCPd+e5/8XqgBeG5Ro6X9+VP73S
ahOVGrh++/649YOcGNNY6mlXpdCBC18AY9yHKZDjzPAPWNxrD6v2TNwb+rHnzGtd
ggqLBtmUO2qCmHqsQAP/WOAJfS+QE+W8mSUXZBEg6Nwl4OLJeOc3N4yjBlykOY1w
YoJkxFtQO3Uh6ymUHzmJ34aV/z9Yh20IoT9m5U649bcaczgRFnDHNQ/wkyAex5ms
PPFVroNQ9zft89gcQb0RRtGFuO2EDG3XGpg00ZWoOjNKiY9YaN5evYB38+m7qm/O
jQRpVIeAAQQAqUZxQHna97nC/btw2TIJpTnDRB79dBtKcwoxADhykKzkC6DwmQ6K
UD8gFq2m77uiL5HpchKGPvYv2X3doIpWpglB9WtQumQF+3b/lM8Jl+cgVllom6D4
3UvBhYDufuB6TKXT/Qvdi5mZDSY8/ZALdg+rpgMl9wUAxAF5A6HLtNEAEQEAAcLA
gwQYAQoADwUCaVSHgAUJA8JnAAIbLgCoCRBW7Vdr1N+awJ0gBBkBCgAGBQJpVIeA
AAoJEHWGzUE7tI73FwQD/jSAUXxc7Gsl9g7t8sqR5e6NdmiEUEZRlfuuEoQBkF5c
q/vR4qAEyl4sg26iqWbuwJgaJ9QP03T40u7Yris1DWPFMGOW9G53ZGWVaDpG9Vja
GASdv6aWk35r3BlFns4RcpHTJjK1l27yi0o6U8oyOzGIEq8dV+JKJPKDIHMnukbY
KiQD/1oj2xq/hsz3KVNvhFThu6e6Y1uvS07ZHGYmSot7ET+qKdstYJ0TYAEudgEf
39eD80XVhuApu2vdtVbjrUt9kxJ5v/QpSp+hcJKfPF7QifW3dc6e5EA7y3pMgDQM
ctWXHRh9EOErZrmYAbwBKgge1WA2csuzAAl0cwuF2WocZVmd
=k76m
-----END PGP PUBLIC KEY BLOCK-----`;

    async function verifySignature() {
        const messageText = document.getElementById('pgp-message').value.trim();
        const resultDiv = document.getElementById('result');
        
        // Reset da UI
        resultDiv.style.display = 'block';
        resultDiv.className = ''; 
        resultDiv.innerHTML = 'ANALISANDO ASSINATURA...';
        resultDiv.style.color = '#fff';

        try {
            // 1. Verificar se é uma mensagem assinada em texto claro (Cleartext)
            if (!messageText.includes('-----BEGIN PGP SIGNED MESSAGE-----')) {
                throw new Error("Formato inválido. Use 'PGP Cleartext Sign' no CyberChef.");
            }

            // 2. Carregar a chave pública do sistema
            const publicKey = await openpgp.readKey({ armoredKey: publicKeyArmored });

            // 3. Ler a mensagem assinada
            const message = await openpgp.readCleartextMessage({ cleartext: messageText });

            // 4. Verificar a assinatura usando APENAS a chave pública
            const verificationResult = await openpgp.verify({
                message: message,
                verificationKeys: publicKey
            });

            // 5. Validar o resultado
            const { verified, keyID } = verificationResult.signatures[0];
            
            try {
                await verified; // Isso lança erro se a assinatura for inválida
                
                // SE CHEGAR AQUI, É SUCESSO
                resultDiv.className = 'success';
                resultDiv.innerHTML = `
                    <h3 style="margin:0">VERIFICADO: ORIGEM CONFIRMADA</h3>
                    <p>ASSINADO POR: 142 (ID: ${keyID.toHex()})</p>
                    <p>INTEGRIDADE: INTACTA</p>
                `;

            } catch (e) {
                // SE A ASSINATURA NÃO BATER
                throw new Error("Assinatura inválida! O texto foi alterado ou não foi assinado pelo 142.");
            }

        } catch (error) {
            console.error(error);
            resultDiv.className = 'failure';
            resultDiv.innerHTML = `
                <h3 style="margin:0">FALHA NA VERIFICAÇÃO</h3>
                <p>${error.message}</p>
            `;
        }
    }
</script>

</body>
</html>
